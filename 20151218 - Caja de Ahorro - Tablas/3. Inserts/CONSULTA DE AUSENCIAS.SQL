        SELECT DISTINCT
               COUNT(PDF.DISABILITY_ID)
          FROM  PAY_ALL_PAYROLLS_F          PAP,
                PER_PERSON_TYPE_USAGES_F    PPTU,
                PER_PERIODS_OF_SERVICE      PPOS,
                PER_ALL_ASSIGNMENTS_F       PAA,   
                PER_PEOPLE_F                PPF,      
                PER_ALL_PEOPLE_F            PAPF,
                PER_DISABILITIES_F          PDF,
                PER_TIME_PERIODS            PTP  
         WHERE 1 = 1
           AND PPF.PERSON_ID = PPTU.PERSON_ID
           AND PPF.PERSON_ID = PPOS.PERSON_ID
           AND PAA.PAYROLL_ID = PAP.PAYROLL_ID
           AND PAA.PERSON_ID = PPF.PERSON_ID
           AND PAPF.PERSON_ID = PPF.PERSON_ID
           AND (PPF.EFFECTIVE_START_DATE = PAPF.EFFECTIVE_START_DATE
            AND PPF.EFFECTIVE_START_DATE = PPTU.EFFECTIVE_START_DATE
            AND PPF.EFFECTIVE_START_DATE = PPOS.DATE_START) 
           AND PAA.PERIOD_OF_SERVICE_ID = PPOS.PERIOD_OF_SERVICE_ID
           AND PPF.REGISTERED_DISABLED_FLAG IS NULL
           AND PDF.PERSON_ID = PPF.PERSON_ID
           AND PDF.PERSON_ID = :P_PERSON_ID
           AND PAP.PAYROLL_ID = PTP.PAYROLL_ID
           AND PTP.TIME_PERIOD_ID = :P_TIME_PERIOD_ID
           AND (   PDF.REGISTRATION_DATE BETWEEN PTP.START_DATE AND PTP.END_DATE
                OR PDF.REGISTRATION_EXP_DATE BETWEEN PTP.START_DATE AND PTP.END_DATE)   
           AND (PDF.CATEGORY = 'RT'
             OR PDF.CATEGORY = 'GRAL'
             OR PDF.CATEGORY = 'MAT')
         GROUP BY PPF.PERSON_ID,
                   PAPF.EMPLOYEE_NUMBER,       
                   PAPF.FULL_NAME,
                   PDF.DISABILITY_ID,
                   PDF.REGISTRATION_DATE, 
                   PDF.REGISTRATION_EXP_DATE