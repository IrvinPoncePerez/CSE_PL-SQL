CREATE TABLE ATET_SB_PAYMENTS_SCHEDULE
(
    PAYMENT_SCHEDULE_ID         NUMBER  NOT NULL,
    LOAN_ID                     NUMBER  NOT NULL,
    PAYMENT_NUMBER              NUMBER,
    PERIOD_NUMBER               NUMBER,
    TIME_PERIOD_ID              NUMBER,
    PERIOD_NAME                 VARCHAR2(250),
    PAYMENT_DATE                DATE,
    PAYROLL_ID                  NUMBER,
    ASSIGNMENT_ID               NUMBER,
    OPENING_BALANCE             NUMBER,
    PAYMENT_AMOUNT              NUMBER,
    PAYMENT_CAPITAL             NUMBER,
    PAYMENT_INTEREST            NUMBER,
    PAYMENT_INTEREST_LATE       NUMBER,
    PAYED_AMOUNT                NUMBER,
    PAYED_CAPITAL               NUMBER,
    PAYED_INTEREST              NUMBER,
    PAYED_INTEREST_LATE         NUMBER,
    OWED_AMOUNT                 NUMBER,
    OWED_CAPITAL                NUMBER,
    OWED_INTEREST               NUMBER,
    OWED_INTEREST_LATE          NUMBER,
    FINAL_BALANCE               NUMBER,
    ACCRUAL_PAYMENT_AMOUNT      NUMBER,
    STATUS_FLAG                 VARCHAR2(50),
    ATTRIBUTE1                  NUMBER,
    ATTRIBUTE2                  NUMBER,
    ATTRIBUTE3                  NUMBER,
    ATTRIBUTE4                  NUMBER,
    ATTRIBUTE5                  NUMBER,
    ATTRIBUTE6                  VARCHAR2(250),
    ATTRIBUTE7                  VARCHAR2(250),
	ATTRIBUTE8                  VARCHAR2(250),
	ATTRIBUTE9                  VARCHAR2(250),
	ATTRIBUTE10                 VARCHAR2(250),
	ATTRIBUTE11                 VARCHAR2(250),
	ATTRIBUTE12                 VARCHAR2(250),
	ATTRIBUTE13                 VARCHAR2(250),
	ATTRIBUTE14                 VARCHAR2(250),
	ATTRIBUTE15                 VARCHAR2(250),
	CREATION_DATE               DATE,
	CREATED_BY                  NUMBER,
	LAST_UPDATE_DATE            DATE,
	LAST_UPDATED_BY             NUMBER
);


ALTER TABLE ATET_SB_PAYMENTS_SCHEDULE
	ADD CONSTRAINT UQ_ATET_SB_PAYMENTS_SCHEDULE UNIQUE (PAYMENT_SCHEDULE_ID)
 USING INDEX ;
 
 
ALTER TABLE ATET_SB_PAYMENTS_SCHEDULE
    ADD CONSTRAINT FK_ATETSBPAYSCH_LOANID 
        FOREIGN KEY (LOAN_ID)
        REFERENCES ATET_SB_LOANS(LOAN_ID);
        
        
CREATE SEQUENCE ATET_SB_PAYMENTS_SCHEDULE_SEQ
  START WITH 1
  NOCYCLE
  NOCACHE
  NOORDER;
  
  
CREATE OR REPLACE TRIGGER ATET_SB_PAYMENTS_SCHEDULE_TGR
BEFORE INSERT
   ON ATET_SB_PAYMENTS_SCHEDULE
   FOR EACH ROW
DECLARE

   var_next_id  NUMBER;

BEGIN

    SELECT ATET_SB_PAYMENTS_SCHEDULE_SEQ.NEXTVAL
      INTO var_next_id
      FROM dual;        
      
    :NEW.PAYMENT_SCHEDULE_ID := var_next_id;

END;