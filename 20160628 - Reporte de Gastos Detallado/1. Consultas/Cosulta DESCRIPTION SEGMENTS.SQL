--XXCALV - Interfase de Polizas


SELECT DISTINCT 
       GL.SEGMENT1,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             1,
                                             GL.SEGMENT1) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL;

SELECT DISTINCT 
       GL.SEGMENT2,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             2,
                                             GL.SEGMENT2) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL
WHERE 1 = 1
  AND GL.SEGMENT1 = :P_SEGMENT1
ORDER BY 1;

SELECT DISTINCT 
       GL.SEGMENT3,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             3,
                                             GL.SEGMENT3) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL
WHERE 1 = 1
  AND GL.SEGMENT1 = :P_SEGMENT1
  AND GL.SEGMENT2 = :P_SEGMENT2
ORDER BY 1;

SELECT DISTINCT 
       GL.SEGMENT4,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             4,
                                             GL.SEGMENT4) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL
WHERE 1 = 1
  AND GL.SEGMENT1 = :P_SEGMENT1
  AND GL.SEGMENT2 = :P_SEGMENT2
  AND GL.SEGMENT3 = :P_SEGMENT3
ORDER BY 1;

SELECT DISTINCT 
       GL.SEGMENT5,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             5,
                                             GL.SEGMENT5) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL
WHERE 1 = 1
  AND GL.SEGMENT1 = :P_SEGMENT1
  AND GL.SEGMENT2 = :P_SEGMENT2
  AND GL.SEGMENT3 = :P_SEGMENT3
  AND GL.SEGMENT4 = :P_SEGMENT4
ORDER BY 1;

SELECT DISTINCT 
       GL.SEGMENT6,
       GL_FLEXFIELDS_PKG.GET_DESCRIPTION_SQL(GL.CHART_OF_ACCOUNTS_ID,
                                             6,
                                             GL.SEGMENT6) SEG_DESCRIPTION
 FROM GL_CODE_COMBINATIONS GL
WHERE 1 = 1
  AND GL.SEGMENT1 = :P_SEGMENT1
  AND GL.SEGMENT2 = :P_SEGMENT2
  AND GL.SEGMENT3 = :P_SEGMENT3
  AND GL.SEGMENT4 = :P_SEGMENT4
  AND GL.SEGMENT5 = :P_SEGMENT5
ORDER BY 1;


SELECT PERIOD_NAME
  FROM GL_PERIODS
 WHERE 1 = 1
   AND YEAR_START_DATE      IS NOT NULL
  AND QUARTER_START_DATE   IS NOT NULL
  AND PERIOD_SET_NAME = 'CAL_GPO CALVARI'
 ORDER BY PERIOD_YEAR,
          PERIOD_NUM
